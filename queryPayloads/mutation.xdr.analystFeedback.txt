mutation xdrAnalystFeedback ( $perSecond:Boolean $analystFeedbackInput:AnalystFeedbackInput! ) {
	xdr ( ) {
		analystFeedback ( input:$analystFeedbackInput  )  {
			storyAnalystFeedbackPayload: story {
				id
				accountId
				analystName
				analystEmail
				accountName
				updatedAt
				createdAt
				playbook
				summary
				incident {
					id
					firstSignal
					lastSignal
					engineTypeMergedIncident: engineType
					vendorMergedIncident: vendor
					producerMergedIncident: producer
					producerName
					connectionTypeMergedIncident: connectionType
					indication
					queryName
					criticality
					source
					ticket
					statusMergedIncident: status
					research
					siteName
					storyDuration
					description
					sourceIp
					analystFeedbackMergedIncident: analystFeedback {
						verdict
						severity
						threatType {
							name
							recommendedAction
							details
						}

						threatClassification
						additionalInfo
					}
					siteMergedIncident: site {
						id
						name
					}
					userMergedIncident: user {
						id
						name
					}
					predictedVerdictMergedIncident: predictedVerdict
					predictedThreatType
					... on MicrosoftEndpoint {
						microsoftEndpointId: id
						microsoftEndpointFirstSignal: firstSignal
						microsoftEndpointLastSignal: lastSignal
						microsoftEndpointEngineType: engineType
						microsoftEndpointVendor: vendor
						microsoftEndpointProducer: producer
						microsoftEndpointProducerName: producerName
						microsoftEndpointConnectionType: connectionType
						microsoftEndpointIndication: indication
						microsoftEndpointQueryName: queryName
						microsoftEndpointSource: source
						microsoftEndpointCriticality: criticality
						microsoftEndpointTicket: ticket
						microsoftEndpointStatus: status
						microsoftEndpointResearch: research
						microsoftEndpointSiteName: siteName
						microsoftEndpointStoryDuration: storyDuration
						microsoftEndpointDescription: description
						microsoftEndpointSourceIp: sourceIp
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						microsoftEndpointPredictedVerdict: predictedVerdict
						microsoftEndpointPredictedThreatType: predictedThreatType
						device {
							id
							deviceName
							osDetailsMicrosoftDeviceDetails: osDetails {
								osType
								osBuild
								osVersion
							}
							loggedOnUsersMicrosoftDeviceDetails: loggedOnUsers {
								id
								name
								... on MicrosoftEndpointUser {
									microsoftEndpointUserId: id
									microsoftEndpointUserName: name
									userSid
									accountName
									domainName
									principalName
								}
								... on CatoEndpointUser {
									catoEndpointUserId: id
									catoEndpointUserName: name
								}
							}
							externalIp
							localIp
							firstSeenDateTime
							avStatusMicrosoftDeviceDetails: avStatus
							healthStatusMicrosoftDeviceDetails: healthStatus
							rbacGroupMicrosoftDeviceDetails: rbacGroup {
								id
								name
							}
							ipInterfaces
							azureAdDeviceId
							onboardingStatusMicrosoftDeviceDetails: onboardingStatus
						}

						alerts {
							id
							title
							description
							threatName
							mitreTechniqueMicrosoftDefenderEndpointAlert: mitreTechnique {
								id
								name
							}
							mitreSubTechniqueMicrosoftDefenderEndpointAlert: mitreSubTechnique {
								id
								name
							}
							createdDateTime
							resourcesMicrosoftDefenderEndpointAlert: resources {
								id
								createdDateTime
								remediationStatusMicrosoftEndpointResource: remediationStatus
								remediationStatusDetails
								tags
								rolesMicrosoftEndpointResource: roles
								verdictMicrosoftEndpointResource: verdict
								... on MicrosoftProcessResource {
									microsoftProcessResourceId: id
									microsoftProcessResourceCreatedDateTime: createdDateTime
									microsoftProcessResourceRemediationStatus: remediationStatus
									microsoftProcessResourceRemediationStatusDetails: remediationStatusDetails
									microsoftProcessResourceTags: tags
									microsoftProcessResourceRoles: roles
									microsoftProcessResourceVerdict: verdict
									processId
									processCommandLine
									imageFile {
										name
										path
										size
										sha1
										sha256
										md5
										issuer
										signer
										publisher
									}

									userAccount {
										id
										name
										... on MicrosoftEndpointUser {
											microsoftEndpointUserId: id
											microsoftEndpointUserName: name
											userSid
											accountName
											domainName
											principalName
										}
										... on CatoEndpointUser {
											catoEndpointUserId: id
											catoEndpointUserName: name
										}
									}

								}
								... on MicrosoftFileResource {
									microsoftFileResourceId: id
									microsoftFileResourceCreatedDateTime: createdDateTime
									microsoftFileResourceRemediationStatus: remediationStatus
									microsoftFileResourceRemediationStatusDetails: remediationStatusDetails
									microsoftFileResourceTags: tags
									microsoftFileResourceRoles: roles
									microsoftFileResourceVerdict: verdict
									fileDetails {
										name
										path
										size
										sha1
										sha256
										md5
										issuer
										signer
										publisher
									}

									detectionStatus
								}
								... on MicrosoftRegistryResource {
									microsoftRegistryResourceId: id
									microsoftRegistryResourceCreatedDateTime: createdDateTime
									microsoftRegistryResourceRemediationStatus: remediationStatus
									microsoftRegistryResourceRemediationStatusDetails: remediationStatusDetails
									microsoftRegistryResourceTags: tags
									microsoftRegistryResourceRoles: roles
									microsoftRegistryResourceVerdict: verdict
									hive
									key
									value
									valueName
									valueType
								}
							}
							activitiesMicrosoftDefenderEndpointAlert: activities {
								id
								resourceId
								parentResourceId
								action
								firstActivityDateTime
								lastActivityDateTime
							}
							criticality
							externalIp
							localIp
							comments
							recommendedActions
							category
							ownerName
							threatFamilyName
							threatType
							resolvedDateTime
							firstActivityDateTime
							lastActivityDateTime
							lastUpdateDateTime
							destinationIp
							destinationUrl
							statusMicrosoftDefenderEndpointAlert: status
							providerAlertId
							alertWebUrl
							determinationMicrosoftDefenderEndpointAlert: determination
							detectionSourceMicrosoftDefenderEndpointAlert: detectionSource
							classificationMicrosoftDefenderEndpointAlert: classification
						}

					}
					... on AnomalyStats {
						anomalyStatsId: id
						anomalyStatsFirstSignal: firstSignal
						anomalyStatsLastSignal: lastSignal
						anomalyStatsEngineType: engineType
						anomalyStatsVendor: vendor
						anomalyStatsProducer: producer
						anomalyStatsProducerName: producerName
						anomalyStatsConnectionType: connectionType
						anomalyStatsIndication: indication
						anomalyStatsQueryName: queryName
						anomalyStatsSource: source
						anomalyStatsCriticality: criticality
						anomalyStatsTicket: ticket
						anomalyStatsStatus: status
						anomalyStatsResearch: research
						anomalyStatsSiteName: siteName
						anomalyStatsStoryDuration: storyDuration
						anomalyStatsDescription: description
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						anomalyStatsSourceIp: sourceIp
						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						anomalyStatsPredictedVerdict: predictedVerdict
						anomalyStatsPredictedThreatType: predictedThreatType
						srcSiteId
						os
						deviceName
						macAddress
						logonName
						clientClass
						drillDownFilter {
							name
							value
							values
						}

						breakdownField
						subjectType
						extra {
							name
							type
							value
						}

						gaussian {
							std
							ss
							z_score
							avg
							n
						}

						metric {
							name
							value
						}

						metricDetails {
							name
							units
						}

						mitres {
							id
							name
						}

						rules
						timeSeries {
							data ( perSecond:$perSecond   )
							label
							sum
							unitsIncidentTimeseries: units
							info
							keyIncidentTimeseries: key {
								measureFieldName
								dimensions {
									fieldName
									value
								}

							}
						}

						targets {
							typeIncidentTargetRep: type
							name
							analysisScore
							infectionSource
							threatReference
							catoPopularity
							threatFeeds
							creationTime
							categories
							countryOfRegistration
							searchHits
							engines
							eventDataIncidentTargetRep: eventData {
								signatureId
								eventType
								threatType
								threatName
								severity
								action
								ruleId
								virusName
								scanResultEvent: scanResult
								appId
								appName
								dnsProtectionCategory
							}
						}

						direction
					}
					... on AnomalyEvents {
						anomalyEventsId: id
						anomalyEventsFirstSignal: firstSignal
						anomalyEventsLastSignal: lastSignal
						anomalyEventsEngineType: engineType
						anomalyEventsVendor: vendor
						anomalyEventsProducer: producer
						anomalyEventsProducerName: producerName
						anomalyEventsConnectionType: connectionType
						anomalyEventsIndication: indication
						anomalyEventsQueryName: queryName
						anomalyEventsSource: source
						anomalyEventsCriticality: criticality
						anomalyEventsTicket: ticket
						anomalyEventsStatus: status
						anomalyEventsResearch: research
						anomalyEventsSiteName: siteName
						anomalyEventsStoryDuration: storyDuration
						anomalyEventsDescription: description
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						anomalyEventsSourceIp: sourceIp
						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						anomalyEventsPredictedVerdict: predictedVerdict
						anomalyEventsPredictedThreatType: predictedThreatType
						srcSiteId
						os
						deviceName
						macAddress
						logonName
						clientClass
						drillDownFilter {
							name
							value
							values
						}

						breakdownField
						subjectType
						extra {
							name
							type
							value
						}

						gaussian {
							std
							ss
							z_score
							avg
							n
						}

						metric {
							name
							value
						}

						metricDetails {
							name
							units
						}

						mitres {
							id
							name
						}

						rules
						timeSeries {
							data ( perSecond:$perSecond   )
							label
							sum
							unitsIncidentTimeseries: units
							info
							keyIncidentTimeseries: key {
								measureFieldName
								dimensions {
									fieldName
									value
								}

							}
						}

						targets {
							typeIncidentTargetRep: type
							name
							analysisScore
							infectionSource
							threatReference
							catoPopularity
							threatFeeds
							creationTime
							categories
							countryOfRegistration
							searchHits
							engines
							eventDataIncidentTargetRep: eventData {
								signatureId
								eventType
								threatType
								threatName
								severity
								action
								ruleId
								virusName
								scanResultEvent: scanResult
								appId
								appName
								dnsProtectionCategory
							}
						}

						direction
					}
					... on Threat {
						threatId: id
						threatFirstSignal: firstSignal
						threatLastSignal: lastSignal
						threatEngineType: engineType
						threatVendor: vendor
						threatProducer: producer
						threatProducerName: producerName
						threatConnectionType: connectionType
						threatIndication: indication
						threatQueryName: queryName
						threatSource: source
						threatCriticality: criticality
						threatTicket: ticket
						threatStatus: status
						threatResearch: research
						threatSiteName: siteName
						threatStoryDuration: storyDuration
						threatDescription: description
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						threatPredictedVerdict: predictedVerdict
						threatPredictedThreatType: predictedThreatType
						srcSiteId
						flowsCardinality
						riskLevel
						os
						deviceName
						macAddress
						threatSourceIp: sourceIp
						logonName
						direction
						clientClass
						events {
							signatureId
							eventType
							threatType
							threatName
							severity
							action
							ruleId
							virusName
							scanResultEvent: scanResult
							appId
							appName
							dnsProtectionCategory
						}

						mitres {
							id
							name
						}

						timeSeries {
							data ( perSecond:$perSecond   )
							label
							sum
							unitsIncidentTimeseries: units
							info
							keyIncidentTimeseries: key {
								measureFieldName
								dimensions {
									fieldName
									value
								}

							}
						}

						targets {
							typeIncidentTargetRep: type
							name
							analysisScore
							infectionSource
							threatReference
							catoPopularity
							threatFeeds
							creationTime
							categories
							countryOfRegistration
							searchHits
							engines
							eventDataIncidentTargetRep: eventData {
								signatureId
								eventType
								threatType
								threatName
								severity
								action
								ruleId
								virusName
								scanResultEvent: scanResult
								appId
								appName
								dnsProtectionCategory
							}
						}

						flows {
							appName
							clientClass
							sourceIp
							sourcePort
							destinationCountry
							destinationIp
							destinationPort
							direction
							createdAt
							referer
							userAgent
							method
							url
							target
							domain
							sourceGeolocation
							destinationGeolocation
							tunnelGeolocation
							httpResponseCode
							dnsResponseIP
							smbFileName
							user
							fileHash
							ja3
						}

					}
					... on ThreatPrevention {
						threatPreventionId: id
						threatPreventionFirstSignal: firstSignal
						threatPreventionLastSignal: lastSignal
						threatPreventionEngineType: engineType
						threatPreventionVendor: vendor
						threatPreventionProducer: producer
						threatPreventionProducerName: producerName
						threatPreventionConnectionType: connectionType
						threatPreventionIndication: indication
						threatPreventionQueryName: queryName
						threatPreventionSource: source
						threatPreventionCriticality: criticality
						threatPreventionTicket: ticket
						threatPreventionStatus: status
						threatPreventionResearch: research
						threatPreventionSiteName: siteName
						threatPreventionStoryDuration: storyDuration
						threatPreventionDescription: description
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						threatPreventionPredictedVerdict: predictedVerdict
						threatPreventionPredictedThreatType: predictedThreatType
						srcSiteId
						flowsCardinality
						riskLevel
						os
						deviceName
						macAddress
						threatPreventionSourceIp: sourceIp
						logonName
						direction
						clientClass
						events {
							signatureId
							eventType
							threatType
							threatName
							severity
							action
							ruleId
							virusName
							scanResultEvent: scanResult
							appId
							appName
							dnsProtectionCategory
						}

						mitres {
							id
							name
						}

						timeSeries {
							data ( perSecond:$perSecond   )
							label
							sum
							unitsIncidentTimeseries: units
							info
							keyIncidentTimeseries: key {
								measureFieldName
								dimensions {
									fieldName
									value
								}

							}
						}

						targets {
							typeIncidentTargetRep: type
							name
							analysisScore
							infectionSource
							threatReference
							catoPopularity
							threatFeeds
							creationTime
							categories
							countryOfRegistration
							searchHits
							engines
							eventDataIncidentTargetRep: eventData {
								signatureId
								eventType
								threatType
								threatName
								severity
								action
								ruleId
								virusName
								scanResultEvent: scanResult
								appId
								appName
								dnsProtectionCategory
							}
						}

						threatPreventionsEvents {
							appName
							clientClass
							sourceIp
							sourcePort
							destinationCountry
							destinationIp
							destinationPort
							direction
							createdAt
							method
							url
							target
							domain
							sourceGeolocation
							destinationGeolocation
							tunnelGeolocation
							dnsResponseIP
							smbFileName
							user
							userAgent
							fileHash
							ja3
							referrer
							httpResponseCode
						}

					}
					... on NetworkXDRIncident {
						networkXDRIncidentId: id
						networkXDRIncidentFirstSignal: firstSignal
						networkXDRIncidentLastSignal: lastSignal
						networkXDRIncidentEngineType: engineType
						networkXDRIncidentVendor: vendor
						networkXDRIncidentProducer: producer
						networkXDRIncidentProducerName: producerName
						networkXDRIncidentConnectionType: connectionType
						networkXDRIncidentIndication: indication
						networkXDRIncidentQueryName: queryName
						networkXDRIncidentSource: source
						networkXDRIncidentCriticality: criticality
						networkXDRIncidentTicket: ticket
						networkXDRIncidentStatus: status
						networkXDRIncidentResearch: research
						networkXDRIncidentSiteName: siteName
						networkXDRIncidentStoryDuration: storyDuration
						networkXDRIncidentDescription: description
						networkXDRIncidentSourceIp: sourceIp
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						networkXDRIncidentPredictedVerdict: predictedVerdict
						networkXDRIncidentPredictedThreatType: predictedThreatType
						networkIncidentTimeline {
							created
							validated
							description
							eventTypeNetworkTimelineEvent: eventType
							incidentId
							networkEventSourceNetworkTimelineEvent: networkEventSource
							eventIds
							acknowledged
							linkId
							linkName
							linkConfigPrecedenceNetworkTimelineEvent: linkConfigPrecedence
							linkStatusNetworkTimelineEvent: linkStatus
							linkConfigBandwidth
							deviceConfigHaRoleNetworkTimelineEvent: deviceConfigHaRole
							deviceHaRoleStateNetworkTimelineEvent: deviceHaRoleState
							socketSerialId
							pop
							isp
							bgpConnectionNetworkTimelineEvent: bgpConnection {
								connectionName
								peerIp
								peerAsn
								catoIp
								catoAsn
							}
							linkQualityIssueNetworkTimelineEvent: linkQualityIssue {
								issueType
								direction
								current
								threshold
							}
							hostIp
							ruleName
							tunnelResetCount
							muted
						}

						storyType
						occurrences
						siteConnectionType
						siteConfigLocation
						acknowledged
						linkId
						linkName
						linkConfigPrecedence
						deviceConfigHaRole
						licenseRegion
						licenseBandwidth
						pop
						isp
						bgpConnection {
							connectionName
							peerIp
							peerAsn
							catoIp
							catoAsn
						}

						hostIp
						ruleName
						muted
						ilmmDetails {
							linkDetailsIlmmDetails: linkDetails {
								linkId
								description
								ispLinkId
								comments
								onboardingStatus
								activeLicense
							}
							ispDetailsIlmmDetails: ispDetails {
								name
								ispAccountId
								supportEmail
								supportPhone
								description
								countryCode
								loaFile {
									fileName
									fileHash
									uploadedAt
								}

							}
							contactsIlmmDetails: contacts {
								name
								phone
								email
							}
						}

					}
					... on CatoEndpoint {
						catoEndpointId: id
						catoEndpointFirstSignal: firstSignal
						catoEndpointLastSignal: lastSignal
						catoEndpointEngineType: engineType
						catoEndpointVendor: vendor
						catoEndpointProducer: producer
						catoEndpointProducerName: producerName
						catoEndpointConnectionType: connectionType
						catoEndpointIndication: indication
						catoEndpointQueryName: queryName
						catoEndpointSource: source
						catoEndpointCriticality: criticality
						catoEndpointTicket: ticket
						catoEndpointStatus: status
						catoEndpointResearch: research
						catoEndpointSiteName: siteName
						catoEndpointStoryDuration: storyDuration
						catoEndpointDescription: description
						catoEndpointSourceIp: sourceIp
						analystFeedback: analystFeedback {
							verdictAnalystFeedback: verdict
							severityAnalystFeedback: severity
							threatTypeAnalystFeedback: threatType {
								name
								recommendedAction
								details
							}
							threatClassification
							additionalInfo
						}

						siteRef: site {
							id
							name
						}

						userRef: user {
							id
							name
						}

						similarStoriesData {
							storyId
							threatTypeName
							verdict
							threatClassification
							similarityPercentage
							indication
						}

						catoEndpointPredictedVerdict: predictedVerdict
						catoEndpointPredictedThreatType: predictedThreatType
						device {
							id
							deviceName
							osDetailsCatoEndpointDeviceDetails: osDetails {
								osType
								osBuild
								osVersion
							}
							loggedOnUsersCatoEndpointDeviceDetails: loggedOnUsers {
								id
								name
								... on MicrosoftEndpointUser {
									microsoftEndpointUserId: id
									microsoftEndpointUserName: name
									userSid
									accountName
									domainName
									principalName
								}
								... on CatoEndpointUser {
									catoEndpointUserId: id
									catoEndpointUserName: name
								}
							}
							macAddress
							externalIp
							localIp
						}

						alerts {
							id
							title
							description
							threatName
							mitreTechniqueCatoEndpointAlert: mitreTechnique {
								id
								name
							}
							mitreSubTechniqueCatoEndpointAlert: mitreSubTechnique {
								id
								name
							}
							createdDateTime
							resourcesCatoEndpointAlert: resources {
								id
								createdDateTime
								remediationStatusCatoResource: remediationStatus
								... on CatoProcessResource {
									catoProcessResourceId: id
									catoProcessResourceCreatedDateTime: createdDateTime
									catoProcessResourceRemediationStatus: remediationStatus
									processId
									processCommandLine
									imageFile {
										name
										path
										size
										sha1
										sha256
										md5
										issuer
										signer
										publisher
									}

									userAccount {
										id
										name
										... on MicrosoftEndpointUser {
											microsoftEndpointUserId: id
											microsoftEndpointUserName: name
											userSid
											accountName
											domainName
											principalName
										}
										... on CatoEndpointUser {
											catoEndpointUserId: id
											catoEndpointUserName: name
										}
									}

								}
								... on CatoFileResource {
									catoFileResourceId: id
									catoFileResourceCreatedDateTime: createdDateTime
									catoFileResourceRemediationStatus: remediationStatus
									fileDetails {
										name
										path
										size
										sha1
										sha256
										md5
										issuer
										signer
										publisher
									}

									detectionStatus
								}
							}
							activitiesCatoEndpointAlert: activities {
								id
								resourceId
								parentResourceId
							}
							criticality
							engineTypeCatoEndpointAlert: engineType
							statusCatoEndpointAlert: status
							endpointProtectionProfile
							externalIp
							localIp
						}

					}
				}

				timeline {
					createdAt
					description
					context
					typeTimelineItem: type
					descriptions
					categoryTimelineItem: category
					additionalInfo
					analystInfoTimelineItem: analystInfo {
						name
						email
					}
				}

			}
		}

	}	
}