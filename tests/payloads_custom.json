{
    "query.accountmetrics.site": {
        "name": "accountMetrics - Site Health Check",
        "description": "Monitor all key performance indicators for a specific site",
        "operation": "query.accountMetrics",
        "payload": {
            "buckets": 24,
            "groupDevices": true,
            "groupInterfaces": true,
            "labels": [
                "bytesDownstream",
                "bytesUpstream",
                "health",
                "lastMileLatency",
                "lastMilePacketLoss",
                "rtt"
            ],
            "siteIDs": [
                "144905"
            ],
            "timeFrame": "last.P1D",
            "perSecond": true,
            "toRate": true
        },
        "timeout": 30,
        "assertions": [
            "accountMetrics.metadata",
            "accountMetrics.sites"
        ]
    },
    "query.accountmetrics.users": {
        "name": "accountMetrics - User Performance Analysis",
        "description": "Analyze network performance for specific users",
        "operation": "query.accountMetrics",
        "payload": {
            "buckets": 24,
            "labels": [
                "health",
                "jitterDownstream",
                "jitterUpstream",
                "lastMileLatency",
                "lastMilePacketLoss",
                "packetsDownstream",
                "packetsUpstream"
            ],
            "timeFrame": "last.P1D",
            "userIDs": [
                "1000000"
            ]
        },
        "timeout": 30,
        "assertions": [
            "accountMetrics.metadata",
            "accountMetrics.sites"
        ]
    },
    "query.accountmetrics.health": {
        "name": "accountMetrics - Quick Health Overview",
        "description": "Get a simple health snapshot without filters",
        "operation": "query.accountMetrics",
        "payload": {
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "accountMetrics.metadata",
            "accountMetrics.sites"
        ]
    },
    "query.accountmetrics.packet_loss": {
        "name": "accountMetrics - Detailed Bandwidth Analysis",
        "description": "Focus on bandwidth utilization with packet loss metrics",
        "operation": "query.accountMetrics",
        "payload": {
            "buckets": 48,
            "labels": [
                "bytesDownstream",
                "bytesUpstream",
                "bytesTotal",
                "bytesDownstreamMax",
                "bytesUpstreamMax",
                "lostDownstreamPcnt",
                "lostUpstreamPcnt"
            ],
            "siteIDs": [
                "132814"
            ],
            "timeFrame": "last.P2D",
            "perSecond": true,
            "withMissingData": true
        },
        "timeout": 30,
        "assertions": [
            "accountMetrics.metadata",
            "accountMetrics.sites"
        ]
    },
    "query.appStats.app_by_risk": {
        "name": "appStats - Apps by Risk Score",
        "description": "Filter and sort applications by risk score >= 5",
        "operation": "query.appStats",
        "payload": {
            "appStatsFilter": [
                {
                    "fieldName": "risk_score",
                    "operator": "gte",
                    "values": [
                        "5"
                    ]
                }
            ],
            "appStatsSort": [
                {
                    "fieldName": "risk_score",
                    "order": "desc"
                }
            ],
            "dimension": [
                {
                    "fieldName": "application_name"
                },
                {
                    "fieldName": "risk_score"
                },
                {
                    "fieldName": "user_name"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                },
                {
                    "aggType": "sum",
                    "fieldName": "flows_created"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStats.app_utilization": {
        "name": "appStats - App Utilization",
        "description": "Query application utilization sorted by traffic for last 7 days",
        "operation": "query.appStats",
        "payload": {
            "dimension": [
                {
                    "fieldName": "application_name"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                },
                {
                    "aggType": "sum",
                    "fieldName": "flows_created"
                }
            ],
            "appStatsSort": [
                {
                    "fieldName": "traffic",
                    "order": "desc"
                }
            ],
            "timeFrame": "last.P7D"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStats.by_country": {
        "name": "appStats - Traffic by Country",
        "description": "Query traffic statistics grouped by site country",
        "operation": "query.appStats",
        "payload": {
            "dimension": [
                {
                    "fieldName": "site_country"
                },
                {
                    "fieldName": "src_site_country_code"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                },
                {
                    "aggType": "count_distinct",
                    "fieldName": "user_name"
                }
            ],
            "timeFrame": "last.P1M"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStats.user_activity": {
        "name": "appStats - User Activity",
        "description": "Query user activity with application, user, and risk dimensions",
        "operation": "query.appStats",
        "payload": {
            "dimension": [
                {
                    "fieldName": "application_name"
                },
                {
                    "fieldName": "user_name"
                },
                {
                    "fieldName": "risk_score"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "downstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "upstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStats.user_app_risk": {
        "name": "appStats - User App Risk",
        "description": "Query application usage by user with risk score analysis",
        "operation": "query.appStats",
        "payload": {
            "appStatsFilter": [],
            "appStatsSort": [],
            "dimension": [
                {
                    "fieldName": "application_name"
                },
                {
                    "fieldName": "user_name"
                },
                {
                    "fieldName": "risk_score"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "downstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "upstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStats.user_bw": {
        "name": "appStats - User Bandwidth",
        "description": "Query user bandwidth consumption with traffic and flows for the last day",
        "operation": "query.appStats",
        "payload": {
            "dimension": [
                {
                    "fieldName": "user_name"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "downstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "upstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                },
                {
                    "aggType": "sum",
                    "fieldName": "flows_created"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStats.user_risk_report": {
        "name": "appStats - User Risk Report",
        "description": "Generate risk report with user and application traffic metrics",
        "operation": "query.appStats",
        "payload": {
            "dimension": [
                {
                    "fieldName": "application_name"
                },
                {
                    "fieldName": "user_name"
                },
                {
                    "fieldName": "risk_score"
                }
            ],
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "downstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "upstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "appStats",
            "appStats.records"
        ]
    },
    "query.appStatsTimeSeries.user_risk_report": {
        "name": "appStatsTimeSeries - Hourly Traffic Analysis",
        "description": "Track traffic patterns throughout the day",
        "operation": "query.appStatsTimeSeries",
        "payload": {
            "buckets": 24,
            "dimension": [
                {
                    "fieldName": "user_name"
                },
                {
                    "fieldName": "application_name"
                }
            ],
            "perSecond": false,
            "measure": [
                {
                    "aggType": "sum",
                    "fieldName": "upstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "downstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "traffic"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "appStatsTimeSeries"
        ]
    },
    // Testing augmented cli operation that is not a part of API schema
    "query.appCategory": {
        "name": "appCategory list",
        "description": "appCategory list - tests array operations",
        "operation": "query.appCategory",
        "payload": {},
        "timeout": 30,
         "assertions": [
            "data",
            "data[0].description",
            "data[0].entity.id"
        ]
    },
    // Testing augmented cli operation that is not a part of API schema
    "entity.site.list": {
        "name": "entityLookup - site list",
        "description": "EntityLookup site list - tests array operations",
        "operation": "entity.site.list",
        "payload": {},
        "timeout": 30,
        "assertions": [
            // Check that result is an array with elements
            {
                "path": "",
                "operator": "type",
                "value": "array"
            },
            // Check that there are more than one element
            {
                "path": "",
                "operator": "length_gt",
                "value": 0
            },
            // Check first element has expected fields (note: entity list returns {site: {...}, description: ...})
            "[0].site.id",
            "[0].site.name",
            "[0].description"
        ]
    },
    "scim.get_users": {
        "name": "SCIM Get Users",
        "description": "SCIM API get users test",
        "operation": "scim.get_users",
        "payload": {},
        "timeout": 30,
        "assertions": [
            "total_users",
            "users"
        ]
    },
    "query.eventsTimeSeries.by_subType": {
        "name": "eventsTimeSeries -  Internet Firewall Events Analysis",
        "description": "Weekly break down by hour of Internet Firewall events by rule_name",
        "operation": "query.eventsTimeSeries",
        "payload": {
            "buckets": 168,
            "eventsDimension": [
                {
                    "fieldName": "rule_name"
                }
            ],
            "eventsFilter": [
                {
                    "fieldName": "event_sub_type",
                    "operator": "is",
                    "values": [
                        "Internet Firewall"
                    ]
                }
            ],
            "eventsMeasure": [
                {
                    "aggType": "sum",
                    "fieldName": "event_count"
                }
            ],
            "perSecond": false,
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "eventsTimeSeries"
        ]
    },
    "query.siteLocation": {
        "name": "siteLocation",
        "description": "Site Location query for city, state, timezone",
        "operation": "query.siteLocation",
        "payload": {
            "filters": [
                {
                    "search": "San Diego",
                    "field": "city",
                    "operation": "startsWith"
                },
                {
                    "search": "nia",
                    "field": "stateName",
                    "operation": "endsWith"
                },
                {
                    "search": "United",
                    "field": "countryName",
                    "operation": "contains"
                }
            ]
        },
        "timeout": 30,
        "assertions": [
            "data"
        ]
    },
    "query.socketPortMetrics.daily_bw_by_interface": {
        "name": "socketPortMetrics - Daily BW by Interface",
        "description": "Daily BW by Interface",
        "operation": "query.socketPortMetrics",
        "payload": {
            "socketPortMetricsDimension": [
                {
                    "fieldName": "socket_interface"
                },
                {
                    "fieldName": "site_name"
                }
            ],
            "socketPortMetricsMeasure": [
                {
                    "aggType": "sum",
                    "fieldName": "bytes_total"
                }
            ],
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "socketPortMetrics.records"
        ]
    },
    "query.socketPortMetricsTimeSeries.daily_bw_by_interface": {
        "name": "Daily Traffic Patterns",
        "description": "Analyze interface traffic patterns throughout the day",
        "operation": "query.socketPortMetricsTimeSeries",
        "payload": {
            "buckets": 24,
            "socketPortMetricsDimension": [
                {
                    "fieldName": "socket_interface"
                },
                {
                    "fieldName": "site_name"
                }
            ],
            "socketPortMetricsMeasure": [
                {
                    "aggType": "sum",
                    "fieldName": "bytes_downstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "bytes_upstream"
                },
                {
                    "aggType": "sum",
                    "fieldName": "bytes_total"
                }
            ],
            "perSecond": false,
            "timeFrame": "last.P1D"
        },
        "timeout": 30,
        "assertions": [
            "socketPortMetricsTimeSeries.summary",
            "socketPortMetricsTimeSeries.series"
        ]
    },
    "raw.auditFeed": {
        "name": "AuditFeed - RAW",
        "description": "Audit fee using raw query",
        "operation": "raw",
        "payload": {
            "query": "query auditFeed ( $accountIDs:[ID!] $timeFrame:TimeFrame! $auditFieldFilterInput:[AuditFieldFilterInput!] ) { auditFeed ( accountIDs:$accountIDs timeFrame:$timeFrame filters:$auditFieldFilterInput ) { accounts { id records{ fieldsMap } } } }",
            "variables": {
                "accountIDs": [
                    15412
                ],
                "auditFieldFilterInput": [],
                "timeFrame": "last.P14D"
            }
        },
        "timeout": 30,
        "assertions": [
            "data.auditFeed.accounts[0].id",
            "data.auditFeed.accounts[0].records"
        ]
    },
    "raw.accountSnapshot": {
        "name": "Account Snapshot - RAW",
        "description": "Account Snapshot using raw query",
        "operation": "raw",
        "payload": {
            "query": "query accountSnapshot ( $accountID:ID ) { accountSnapshot ( accountID:$accountID ) { id timestamp } }",
            "variables": {
                "accountID": "15412"
            },
            "operationName": "accountSnapshot"
        },
        "timeout": 30,
        "assertions": [
            "data.accountSnapshot.id",
            "data.accountSnapshot.timestamp"
        ]
    }
}